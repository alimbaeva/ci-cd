name: CI/CD Workflow

on:
  push:
    branches:
      - 'feature/*'  # Trigger for any push to a branch starting with 'feature/'
  pull_request:
    branches:
      - 'main'  # Trigger for PRs targeting 'main'

jobs:
  # Job for validation and testing
  test:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v2

      - name: Set up Node.js
        uses: actions/setup-node@v2
        with:
          node-version: '16'  # Specify your Node.js version

      - name: Install dependencies
        run: |
          npm install

      - name: Run tests
        run: |
          npm run test  # or the appropriate command to run your tests

  check-branch-name:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v2

      - name: Check branch name

        run: |
          branch_name=$(git symbolic-ref --short HEAD)
          echo "test branch_name"
          if [[ ! "$branch_name" =~ ^feature/.* ]]; then
            echo "❌ Неверное имя ветки. Имя ветки должно начинаться с 'feature/'."
            exit 1
          fi
          echo "Имя ветки корректное: $branch_name"

  # Job for deployment (optional, can be customized)
  deploy:
    needs: test
    runs-on: ubuntu-latest
    if: success()

    steps:
      - name: Checkout code
        uses: actions/checkout@v2

      - name: Deploy to production (example)
        run: |
          # Replace with your actual deployment command
          echo "Deploying application..." 
